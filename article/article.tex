\documentclass[draft=True]{revtex4-2}
\newcommand{\zreco}{\ensuremath{\cos{(\theta_z^{reco})}}}
\newcommand{\ztrue}{\ensuremath{\cos{(\theta_z^{true})}}}
\newcommand{\emm}{\ensuremath{\epsilon_{\mu\mu}}}
\newcommand{\emt}{\ensuremath{\epsilon_{\mu\tau}}}
\newcommand{\eet}{\epsilon_{e\tau}}
\newcommand{\eem}{\epsilon_{e\mu}}
\newcommand{\ett}{\ensuremath{\epsilon_{\tau\tau}}}
\newcommand{\ep}{\ensuremath{\epsilon^\prime}}
\renewcommand{\ne}{\nu_e}
\newcommand{\Ereco}{E^{reco}}
\newcommand{\Etrue}{E^{true}}
\newcommand{\nm}{\nu_\mu}
\newcommand{\nt}{\nu_\tau}
\newcommand{\ane}{\bar\nu_e}
\newcommand{\anm}{\bar\nu_\mu}
\newcommand{\ant}{\bar\nu_\tau}
\newcommand{\dm}{\Delta m^2_{31}}
\newcommand{\sth}{\sin^2(2\theta_{23})}

\usepackage{physics,amsmath, amsfonts, siunitx, amssymb, graphicx, subcaption}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\begin{document}
\section{Formalism}
Non-standard interactions are sub-leading contributions to neutrino flavor transitions arising from neutrino interactions with 
matter fermions not considered in the Standard Model. We consider matter NSIs arising from the neutral current NSIs, which exclude production 
and detection effects. An effective four-fermion Lagrangian for this type of interaction can be written as
\begin{align}
   \mathcal{L}_{\mathrm{NC}} &= -2 \sqrt{2} G_{F} \epsilon_{\alpha \beta}^{f X}\left(\bar{\nu}_{\alpha} \gamma^{\mu} P_{L} \nu_{\beta}\right)\left(\bar{f} \gamma_{\mu} P_{X} f\right)\,,
\end{align}
where NC denotes the neutral current interaction with 
$f \in \{e,u,d\}$, and $P_X$ is the chirality projection operators with $X \in \{L,R\}$.  

For chirality $X$, the NSI Hamiltonian takes the form 
\begin{align}
   H &= \frac{1}{2E} UM^2U^\dagger + \sqrt{2}G_F n_e \text{diag}(1,0,0) + \sqrt{2}G_F \sum_f n_f \epsilon^{fX}
\end{align}

We have no independent sensitivity for the chirality of $\epsilon^X$, so we sum over these to obtain the vector part as $\epsilon^{fV}_{\alpha\beta} = \epsilon^{fL}_{\alpha\beta}+ \epsilon^{fR}_{\alpha\beta}$.
Moreover, we normalize the fermion number density $n_f$ by
the electron number density $n_e$. Our matter study will be wholly confined to the interior of the Earth, where we assume electrical neutrality and equal distribution of neutrons and protons, 
so we use the relations $n_u/n_e \simeq n_d/n_e \simeq 3$.
The effective NSI parameters in matter now take the form
\begin{align} \label{eq:epsilon}
    \epsilon_{\alpha\beta} &= \sum_{f,X} \frac{n_f}{n_e} \epsilon^{fX}_{\alpha\beta} \nonumber \\
                           &= \epsilon_{\alpha\beta}^{eV} + 3\epsilon_{\alpha\beta}^{uV} + 3\epsilon_{\alpha\beta}^{dV}
\end{align}
We note that our definition of $\epsilon_{\alpha\beta}$ differs from some texts, where the quark number density is used to normalize
the parameters\cite{deepcoreNSI}.


With the matter potential $V = \sqrt{2}G_F n_e$, we write
\begin{align} \label{eq:H_NSI}
   H &= \frac{1}{2E} UM^2U^\dagger + V\,
   \begin{bmatrix}
      1 + \epsilon_{ee} & \epsilon_{e\mu} & \epsilon_{e\tau}  \\
      \epsilon_{e\mu} & \epsilon_{\mu\mu} & \epsilon_{\mu\tau}  \\
      \epsilon_{e \tau} & \epsilon_{\mu\tau} & \epsilon_{\tau\tau}
  \end{bmatrix}\,,
\end{align}
where we have assumed the components of the NSI matrix to be real. To see the effect of a NSI, we have plotted a probability difference in the low energy range in Fig.~\ref{fig:Pmm_asymmetry}, and study
the flux ratio in Fig.~\ref{fig:flux_ratio}.

\section{Detector formalism}
The neutrino flux at the detector is calculated by propagating the atmospheric neutrino flux~\cite{hondapaper} through the Earth by solving the 
SchrÃ¶dinger equation for varying density. The Earth density profile is taken from the PREM~\cite{PREM}. The baseline for a given trajectory is determined using an average neutrino
production height of 15 km and an Earth radius of 6371 km. The propagation does not include neutrino absorption.
%TODO: add more here? are there more effects than just absoption missing? justify absorption missing?


The oscillation probability $P_{\alpha \beta}$ acts as a weight to the atmospheric flux, yielding the propagated flux at detector level for flavor $\beta$ as 
\begin{align}\label{eq:propFlux}
    \phi_\beta^\text{det} = \sum_\alpha P_{\alpha\beta} \phi_\alpha^\text{atm} \,,
\end{align}
where we sum over the initial lepton flavors $\alpha \in \{e,\mu, \bar{e}, \bar{\mu}\}$. To illustrate the impact of $\emt$ on both probability
and flux level, we plot the flux ratios resulting from Eq.~\ref{eq:propFlux} in Fig.~\ref{fig:flux_ratio}. In the left panel, we have marked the region in which 99\% of the 
DeepCore cascade events originating from $\ne$ and $\nt$ fluxes are contained. In the right panel, we show the two regions in which 99\% of the IceCube 
and DeepCore track events originating from $\nm$ fluxes are contained. Starting with the $\nm$ flux ratio, we see that the only clear signal discernible to the IceCube detector
is a flux deficiency of a factor of $\sim 10^2$ from core-crossing neutrinos within a zenith range of $\ztrue > -0.87$. DeepCore on the other hand, 
observes multiple fringes of flux surpluses with a factor $\sim 10$. The strongest surplus at \SI{20}{\GeV} is very weakly zenith dependent, a stark contrast to the
energy-independent but zenith-sensetive IceCube deficiency.
%TODO: check values above after final plot of flux ratios
For the fluxes which drives cascades, we have to resort to the DeepCore detector alone. %TODO: fill more
Here we see a somewhat weaker signal, this time a zenith-independent deficiency. 
%TODO: fill with conclusion

\begin{figure}[!tb]\label{fig:flux_ratio}
   \begin{center}
      \includegraphics[width=0.8\linewidth]{figures/flux_ratio.pdf}
   \end{center}
   \caption{Ratio of detector NSI to SI atmospheric fluxes. We set $\emt = -0.05$, and all other $\epsilon_{\alpha\beta}=0$. 
   Within the dotted (dashed) lines, 99\% of the  DeepCore (IceCube) MC events are contained. Since we limit our IceCube study to muon tracks,
   a dashed region is omitted in the left panel.}
\end{figure}% need high emt and log to show both cascade and track features at the same time.
%otherwise, the cascade ratio overpowers the track one.

\subsection{IceCube}\label{ch:ICmethod}
We obtain the data from the IC-86 sterile data release~\cite{IC2020}. The event rate for each bin reads
\begin{align}\label{eq:ICevents}
   N_{ij} &= T\sum_\beta \int_{(\cos{\theta_z^r})_i}^{(\cos{\theta_z^r})_{i+1}} \dd \cos{\theta^r_z} \int_{E^r_{j}}^{E^r_{j+1}} \dd E^r \int_0^\pi R(\theta^r,\theta^t) \dd \cos{\theta^t} \int_0^\infty \phi_\beta^\text{det}  A^\text{eff} R(E^r,E^t) 
   \dd E^t\,,
\end{align}
where $T$ is the live time of the detector, and $A^\text{eff}$ its effective area averaged over the flavors $\beta$ from~\cite{ICaeff}. $R(x^r,x^t)$ is a resolution function, 
which is responsible for the smearing between the reconstructed and true parameters $x^r$ and $x^t$, respectively. We assume a log-normal distribution, giving it the form 
\begin{align}
    R(x^r, x^t) = \frac{1}{\sqrt{2\pi} \sigma_{x^r}x^r} \exp\left[-\frac{(\log x^r-\mu(x^t))^2}{2\sigma_{x^r}^2}\right]\,.
\end{align}
However, the energy reconstruction is biased~\cite{weaverEvidenceAstrophysicalMuon}, which means that we don't make the assumption that $\mu(E^t) =E^r$. To model this relationship between $\Etrue$ and $\Ereco$, we train a Gaussian process regressor on the dataset~\cite{IC2016}, from which
we can extract a predicted mean and standard deviation for a given $E^{reco}$. We then take the $\Etrue$ points of the 99th percentile of each distribution to obtain
the limits of $\Etrue$ at which to integrate over. We take the angular resolution function to be identically unity since the angle resolution in IceCube for track-like events is less than $\SI{2}{\degree}$, making $\ztrue$ coincide with $\zreco$ for our study. 

\subsection{DeepCore}\label{ch:DCmethod}
In this part, we use the publically available DeepCore data sample~\cite{DC2019data} which is an updated version of what was used by the 
IceCube collaboration in a $\nu_\mu$ disapprearance analysis~\cite{DC2018mudisappearance}.

The detector systematics include ice absorption and scattering, and overall, lateral, and head-on optical efficiencies of the DOMs. 
They are applied as correction factors using the best-fit points from the DeepCore 2019 $\nu_\tau$ appearance 
analysis~\cite{DC2019tauappearance}.

The data include 14901 track-like events and 26001 cascade-like events, both divided into eight 
$ \log_{10}E^{reco} \in [0.75,1.75]$ bins, and eight $\zreco \in [-1,1]$ bins. Each event has a Monte Carlo weight $w_{ijk,\beta}$,
from which we can construct the event count as
\begin{align}\label{eq:MCevents}
    N_{ijk} &= C_{ijk}\sum_{\beta}w_{ijk,\beta}\, \phi_\beta^\text{det}\,,
\end{align}
where $C_{k\beta}$ is the correction factor from the detector systematic uncertainty and $\phi_\beta^\text{det}$ is defined as Eq.~\ref{eq:propFlux}. We have now substituted the effect of the Gaussian smearing 
by treating the reconstructed and true quantities as a migration matrix. 

The oscillation parameters used on our DeepCore simulations are from the
best-fit in the global analysis in~\cite{nufit}: $\theta_{12} = \SI{33.44}{\degree},\, \theta_{13} = \SI{8.57}{\degree},\, \Delta m^2_{21} =  \SI{7.42}{\electronvolt^2}$, and we 
marginalize over $\dm$ and $\theta_{23}$.

We plot the normalized event difference $(N_{NSI} - N_{SI})/\sqrt{N_{SI}}$ where $N_{SI}$ $(N_{NSI})$ are the numbers of expected events
assuming standard (non-standard) interactions in Fig.~\ref{fig:event_pulls}. This illustrates the expected sensitivity of DeepCore for the NSI parameters.


\subsection{PINGU}\label{ch:PINGUmethod}
The methodology behind the PINGU simulations are the same as with our DeepCore study~\ref{ch:DCmethod}. We use the public MC~\cite{PINGUdata}, which allows us to construct the event count as in Eq.~\ref{eq:MCevents}.
However, since no detector systematics is yet modelled for PINGU, the correction factors $C_{ijk}$ are all unity.
As with the DeepCore data, the PINGU MC is divided into eight 
$\log_{10}E^{reco} \in [0.75,1.75]$ bins, and eight $\zreco \in [-1,1]$ bins for both track- and cascade-like events. Just as with DeepCore, 
we plot the events pulls for cascades and tracks in Fig.~\ref{fig:event_pulls}. %TODO:talk about this
We generate `data' by predicting the event rates at PINGU with the following best-fit parameters from~\cite{nufit}, except for the CP-violating phase which is set to zero for simplicity.

\begin{align}\label{eq:PINGUparams}
    &\Delta m^2_{21} =  \SI{7.42e-5}{\electronvolt^2},\hspace{0.5em} \dm =  \SI{2.517e-3}{\electronvolt^2}, \nonumber \\
    &\theta_{12} = \SI{33.44}{\degree},\hspace{1em} \theta_{13} = \SI{8.57}{\degree},\hspace{1em} \theta_{23} = \SI{49.2}{\degree}, \hspace{1em} \delta_\text{CP} = 0\,.
\end{align}


\section{Results}
In this section, we present the results from the experiments alone, as well as jointly. 
\subsection{Methodology}\label{sec:method}
For our analyses, we define our $\chi^2$ as
\begin{align} \label{eq:chisq}
    \chi^{2}(\hat{\theta},\alpha,\beta, \kappa)=\sum_{ijk} \frac{\left(N^\text{th}-N^\text{data}\right)_{ijk}^{2}}
    {\left(\sigma^\text{data}_{ijk}\right)^{2} + \left(\sigma^\text{syst}_{ijk}\right)^{2}}+ 
    \frac{(1-\alpha)^2}{\sigma_\alpha^2} + \frac{\beta^2}{\sigma_\beta^2}\,
\end{align}
where we minimize over the model parameters $\hat{\theta} \in \{\dm, \theta_{23}, \epsilon\}$, the penalty terms $\alpha$ and $\beta$, and the free parameter $\kappa$.
$N_{ijk}^\text{th}$ is the expected number of events from theory, and $N_{ijk}^\text{data}$ is the observed number of events in that bin. We set $\sigma_\alpha = 0.25$ as the atmospheric flux normalization error, and $\sigma_\beta = 0.04$ as the zenith angle slope error~\cite{hondapaper}. 
The observed event number has an associated Poissonian uncertainty $\sigma_{ijk}^\text{data} = \sqrt{N_{ijk}^\text{data}}$.
For IceCube, the event count takes the form
\begin{align}
    N^\text{th}_{ijk} = \alpha\left[1+\beta (0.5 + \zreco_i )\right] N_{ijk}(\hat{\theta})\,,
\end{align}
with $N_{ijk}(\hat{\theta})$ from Eq.~\ref{eq:ICevents}. Here, we allow the event distribution to rotate around the median zenith angle of $\zreco = -0.5$.

For DeepCore and PINGU, and the event count takes the form
\begin{align}
    N^\text{th}_{ijk} = \alpha\left[1+\beta \zreco_i \right] N_{ijk}(\hat{\theta}) + \kappa N_{ijk}^{\mu_{atm}}\,,
\end{align}
with $N_{ijk}(\hat{\theta})$ from Eq.~\ref{eq:MCevents}. $N_{ijk}^{\mu_{atm}}$ is the muon background, which is left to float freely in the DeepCore analysis.
The background at PINGU can be considered neglible to first order~\cite{PINGUdata}, and we thus put $\kappa=0$ when calculating the PINGU $\chi^2$\,. 
For DeepCore and PINGU, the median zenith angle is $\zreco = 0$, we allow the event count to rotate around this point.

We treat the uncorrelated systematic uncertanties differently for each detector. For IceCube, we set $\sigma_{ijk}^\text{syst} = f\sqrt{N_{ijk}^\text{data}}$. We consider (best) worst-case scenarios in IceCube assuming
$(f=5\%)$, $f=15\%$. For PINGU, we use the same form but instead assume $f=0\%$ and $f=5\%$ for the best and worst-cases respecively. %TODO: maybe source/justification for these values?
For DeepCore, we use the provided systematic error distribution which accounts for uncertanties in the finite MC statistics and in the data-driven 
muon background estimate~\cite{DC2019data}. This is summarized in Table~\ref{table:syst_errors}.  %TODO segue
{\renewcommand{\arraystretch}{1.2}
\begin{table}
   \begin{tabular}{lcc}
      \hline \hline
      Experiment & Worst case & Best case \\
      \hline
      IceCube & $15\%$ & $5\%$ \\
      DeepCore & - & - \\
      PINGU & $5\%$ & $0\%$ \\
      \hline \hline
   \end{tabular}
   \caption{Definition of the worst and best case scenarios considered in each experiment, modelled by $\sigma_{ijk}^\text{syst} = f\sqrt{N_{ijk}^\text{data}}$ with $f$ from the table.
   We do not consider different DeepCore scenarios because the systematic error distribution there is already given in the data release~\cite{DC2019data}.}\label{table:syst_errors}
\end{table}

\subsection{Constraining the NSI parameters}
First, we set all standard oscillation parameters to their current best-fit values of Eq.~\ref{eq:PINGUparams}, except for $\dm$ and $\theta_{23}$, 
which we marginalize over their $3\sigma$ ranges of \SI{2.435e-3} to \SI{2.598e-3}{\electronvolt^2} and \SI{40.1} to \SI{51.7}{\degree} respectively. %TODO: make unit ranges nicer.
After the oscillation parameters have been marginalized out, we plot $\Delta \chi^2$ for each of the four NSI parameters in Fig.~\ref{fig:3D_NO}. We record the 
confidence levels in Table.~\ref{table:IC_DC_results} for DeepCore and IceCube, and best-fit points in Table ~\ref{table:bestfit}.

\begin{figure}[!tb]
   \begin{center}
      \begin{subfigure}{0.45\textwidth}
         \includegraphics[width=1\linewidth]{figures/joint_3D_NO.pdf}
         \caption{Normal ordering}\label{fig:joint_3D}
      \end{subfigure}
    \end{center}
    \caption{Expected $\Delta \chi^2$ after three years of data.
    $\dm$ and $\theta_{23}$ and have been marginalized out, and all other NSI 
    parameters other than the one shown in each panel are fixed to zero.}\label{fig:3D_NO}
 \end{figure}
%TODO: dont put pingu and dc side by side since pingu is generated.. include 3sigma if possible?


To see the effect of a NSI at probability level, we plot the muon survival probability difference $P_{\mu\mu}(\epsilon^+_{\mu\tau}) - P_{\mu\mu}(\epsilon^-_{\mu\tau})$, where 
$\epsilon^\pm_{\mu\tau} = \pm 0.05$ in Fig.~\ref{fig:Pmm_asymmetry}. We can explain the asymmetry in  by looking looking at the oscillogram. Muon events are the most abundant DeepCore/PINGU, and it suffices to study $P_{\mu\mu}$ to explain the asymmetry. 
We see see that positive $\emt$ generates a slightly higher $P_{\mu\mu}$ for energies around \SI{20}{\GeV} (blue area),
while negative $\emt$ produces higher $P_{\mu\mu}$ for almost all other combinations of ${\Etrue,\ztrue}$. As we see in Fig.~\ref{fig:flux_ratios}, this muon survival abundance 
is indeed preserved at flux level.

\begin{figure}[!tb]
\begin{center}
   \includegraphics[width=0.4\linewidth]{figures/Pmm_asymmetry.pdf}
\end{center}
\caption{The ratio $P_{\mu\mu}(\epsilon^+_{\mu\tau}) - P_{\mu\mu}(\epsilon^-_{\mu\tau})$ using  $\epsilon^\pm_{\mu\tau} = \pm 0.05$ in the DeepCore/PINGU energy range. Negative $\emt$ has the strongest signal, as the thin blue 
region stemming from $\emt = 0.05$ is less prominent than the red regions from $\emt=-0.05$.}\label{fig:Pmm_asymmetry}
\end{figure}
\begin{figure}[!tb]
   \begin{center}
      \includegraphics[width=0.4\linewidth]{figures/emt_events.pdf}
   \end{center}
   \caption{The best-fit event count ratio from each detector for $\emt = \pm 0.01$.}\label{fig:emt_events}%TODO: improve caption?
 \end{figure}
As we see in Fig.~\ref{fig:emt_events}, the binned PINGU event counts display strong differences for many bins, giving a high $\Delta \chi^2$ on both sides of $\emt=0$ and slightly higher for $\emt=-0.01$. DeepCore on the other hand, 
has fewer bins where the event count for $\emt=-0.01$ surpasses the event count for $\emt=+0.01$, giving weaker statistics for the negative side.

Comparing Fig.~\ref{fig:emt_events} with the flux ratios in Fig.~\ref{fig:flux_ratio}, we see that the reconstruction of PINGU is
superior to DeepCore, since the event ratio $\log{(N^+_{NSI}/N^-_{NSI})}$ (which is in reconstructed quantities) more closely matches the flux ratio $\log{(\phi_{NSI}/\phi_{SI})}$ (which is in true quantities).
This is most evident below \SI{20}{\GeV}, where the DeepCore reconstruction has washed out the fringes.

%TODO: ploit contour for ett-emt
{\renewcommand{\arraystretch}{1.3}
 \begin{table}
   \begin{center}
   \begin{tabular}{lcccc}
      \hline \hline
      Parameter & Best 90\% CL & Best $3\sigma$ & Worst 90\% CL & Worst $3\sigma$\\
      \hline & \multicolumn{4}{c}{IceCube}  \\
      $\emt$ & [-0.0098, 0.009 ] & [-0.0148, 0.014 ] & [-0.0152, 0.0145] & [-, -] \\\\
      & \multicolumn{4}{c}{DeepCore}  \\[0.3em]
      $\ett$ & [-0.029, 0.045] & [-, -]& [-0.029, 0.045] & [-, -] \\
      $\emt$ & [-0.015, 0.0048] & [-, 0.015]& [-0.015, 0.0048] & [-, 0.015] \\
      $\eem$ & [-0.072, 0.075] & [-0.132, 0.127]& [-0.072, 0.075] & [-0.132, 0.127]\\
      $\eet$ & [-0.074, 0.141] & [-0.174, 0.20  ]& [-0.074, 0.141] & [-0.174, 0.20  ]\\\\
      &\multicolumn{4}{c}{IceCube + DeepCore}  \\
      $\emt$ & [-0.0182,  0.00030] & [-, 0.0104] & [-0.0185, 0.00030] & [-, 0.0104] \\
      \hline
      \hline
   \end{tabular}
   \end{center}
   \caption{IceCube and DeepCore results from the $\Delta \chi^2$ in Fig.~\ref{fig:3D_NO}. IceCube best and worst case refers to 
   the systematic uncertainty scenarios considered as in Table~\ref{table:syst_errors}}\label{table:IC_DC_results}
\end{table}
\begin{table}
   \begin{tabular}{lcccc}
      \hline \hline
      Parameter & Best 90\% CL & Best $3\sigma$ & Worst 90\% CL & Worst $3\sigma$\\
      \hline & \multicolumn{4}{c}{PINGU} \\
      $\ett$ & [-0.0326, -] & [-0.0482, ] & [-0.0371, -] & [-, -] \\
      $\emt$ & [-0.0065, 0.0071] & [-0.011, 0.013] & [-0.0078, 0.0087] & [-0.0136, 0.0162] \\
      $\eem$ & [-0.062, 0.057] & [-0.122, 0.103] & [-0.1057, 0.0799] & [-0.198, 0.141]\\
      $\eet$ & [-0.069, 0.077] & [-0.121, 0.133] & [-0.1072, 0.1022] & [-0.1805, 0.1633]\\\\
      & \multicolumn{4}{c}{DeepCore + PINGU} \\
      $\ett$ & [-0.028, 0.043] & [-0.043, -] & [-0.0285,  0.0423] & [-0.0447, -]\\
      $\emt$ & [-0.0067, 0.0049] & [-0.0109,  0.0101] & [-0.0049, 0.0086] & [-0.0098, 0.0146]\\
      $\eem$ & [-0.048, 0.048]  & [-0.090, 0.085] & [-0.0721, 0.0503] & [-0.1262, 0.0931]\\
      $\eet$ & [-0.053, 0.072]  & [-0.101, 0.118] & [-0.0901, 0.0624] & [-0.1491, 0.1168]\\\\
      & \multicolumn{4}{c}{IceCube + DeepCore + PINGU}  \\
      $\emt$ & [-0.0088,  0.003 ] & [-0.0128, 0.0081] & [-0.01, 0.0028] & [-0.0145, 0.0087]\\
      \hline
      \hline
   \end{tabular}
   \caption{PINGU and joint results from the $\Delta \chi^2$ in Fig.~\ref{fig:3D_NO}. PINGU best and worst cases refers to 
   the systematic uncertainty scenarios considered as in Table.~\ref{table:syst_errors}}\label{table:PINGU_joint_results}
\end{table}

\begin{table}
   \begin{center}
   \begin{tabular}{lccc}
           \hline \hline & \multicolumn{3}{c} {\text {Best fit}} \\
           \cline { 2 - 4 } Parameter & $\dm$ & $\theta_{23}$  & $\epsilon$  \\
           \hline \multicolumn{3}{c} {\hspace{2.5cm} DeepCore }  \\[0.1em]
           $\ett$ &  2.435 & 47.84 & 0.0125 \\
           $\emt$ &  2.435 & 43.97 & -0.005 \\
           $\eem$ &  2.435 & 43.97 & 0 \\
           $\eet$ &  2.435 & 43.97  & 0.05 \\\\
           \multicolumn{3}{c} {\hspace{2.5cm} IceCube } \\
           $\emt$ &  2.435 & 51.70 & 0 \\
           \multicolumn{3}{c} {\hspace{2.5cm} IceCube + DeepCore } \\
           $\emt$ &  2.517 & 43.97 & -0.01 \\
           \hline
           \hline
   \end{tabular}
   \end{center}
   \caption{Best fit points for $\dm$ and $\theta_{23}$ are given in units of $\si{10^{-3}\eV\squared}$ and
   degrees, respectively.}\label{table:bestfit}
\end{table}
Comparing the PINGU results in Fig.~\ref{fig:PINGU_3D_NO} and the DeepCore results in Fig.~\ref{fig:DC_3D_NO}, we note that 
the best-fit for each NSI parameter for the PINGU experiment is expected to be zero. This is because the `data' we generated during 
the PINGU simulations assumes no NSI since they have yet to be observed in nature. This introduces a non-NSI bias in our joint analysis,
since PINGU has stronger statistics than DeepCore, and will thus pull the joint $\chi^2$ towards $\epsilon =0$.

%TODO: segue to joint
For the joint analysis, we follow the parameter goodness-of-fit prescription~\cite{maltoni2003} and construct the joint $\chi^2$ as 
\begin{align}\label{eq:joint_chisq}
    \chi^2_\text{joint} = \chi^2_\text{IC} + \chi^2_\text{DC} + \chi^2_\text{P} - \chi^2_{IC,min} - \chi^2_\text{DC,min} - \chi^2_\text{P,min}\,
\end{align}
with test statistic $\chi^2_\text{joint,min}$. The results are shown in Fig.~\ref{fig:joint_3D} and summarized in Table~\ref{table:DC_PINGU_results}.
\newpage


 \begin{figure}[t]
   \begin{center}
      \begin{subfigure}{0.38\textwidth}
         \includegraphics[width=1\linewidth]{figures/PINGU_event_pulls.pdf}
         \caption{PINGU}\label{fig:PINGU_event_pulls}
      \end{subfigure}
      \begin{subfigure}{0.4\textwidth}
         \includegraphics[width=1\linewidth]{figures/DC_event_pulls.pdf}
         \caption{DeepCore}\label{fig:DC_event_pulls}
      \end{subfigure}
    \end{center}
   \caption{Expected pulls of the form $(N_{NSI} - N_{SI})/\sqrt{N_{SI}}$ for PINGU and DeepCore after 3 years. We compare the NSI event count with $\emt=-0.01$
    to the standard interaction count}\label{fig:event_pulls} 
\end{figure}%TODO: redo these with same emt as flux_ratio?

% \begin{figure}[b]
%    \begin{center}
%       \includegraphics[width=0.2\linewidth]{figures/joint_3D_NO.pdf}
%    \end{center}
%    \caption{Expected joint $\Delta \chi^2$ from Eq.~\ref{eq:joint_chisq} for normal ordering.}
%    \label{fig:joint_3D}
% \end{figure}
%TODO:  Discussion on impact of IC on chisq.?

%TODO: subsection about comparison between different papers. 

\begin{figure}
   \includegraphics[width=0.9\textwidth]{figures/PINGU_2D_all_f0.pdf}
\end{figure}
\begin{figure}
   \includegraphics[width=0.9\textwidth]{figures/PINGU_2D_all_f5.pdf}
\end{figure}
\bibliographystyle{elsarticle-num}
\bibliography{article}

\newpage
\begin{tabular}{p{55mm}p{55mm}p{55mm}}
   DeepCore (2017)
      \begin{itemize}
         \item[$\checkmark$] Honda atmospheric fluxes
         \item[$\times$] Only look at tracks and $\emt$
         \vspace{1em}  
         \item[$\times$] DC Monte Carlo from an older dataset 
         \item[$\times$] 8 E bins from $\SI{6.3}{\electronvolt^2}$ to $\SI{56}{\electronvolt^2}$
         \item[$\times$] 8 z bins from -1 to 0 
         \item[$\times$] Use "Overall" and "relative $\ne$ to $\nm$" normalization
         \item[$\times$] Prior on spectral index
         \item[$\times$] No zenith angle normalization
         \item[$\checkmark$] No priors on $\dm, \theta_{23},\theta_{13}$
      \end{itemize} &
    Demidov (2020) DC analysis
      \begin{itemize}
         \item[$\checkmark$] Honda atmospheric fluxes
         \item[$\checkmark$] Looks at tracks + cascades for $\emt$ and $\ett$
         \item[$\checkmark$] Data and Monte Carlo from DC 2018
         \item[$\checkmark$] 8 E bins from $\SI{5.6}{\electronvolt^2}   $ to $\SI{56}{\electronvolt^2}$
         \item[$\checkmark$] 8 z bins from -1 to 1
         \item[$\times$] Use "Overall" and "relative $\ne$ to $\nm$" normalization
         \item[$\times$] Prior on spectral index
         \item[$\times$] No zenith angle normalization
         \item[$\checkmark$] No priors on $\dm, \theta_{23}$
         \item[$\checkmark$] Fixes $\Delta m^2_{21}, \theta_{12}, \theta_{13}$
         \item[$\times$] Uncertainty on hadron production in atmosphere
         \item[$\times$] Uncertainty on neutrino nucleon cross section 
      \end{itemize} &
    This DC+PINGU analysis
      \begin{itemize}
         \item[$\checkmark$] Honda atmospheric fluxes
         \item[$\checkmark$] Tracks and cascades for all flavors
         \vspace{1em} 
         \item[$\checkmark$] Reco $\to$ true mapping from Monte Carlo migration matrix
         \item[$\checkmark$] 8 E bins from $\SI{5.6}{\electronvolt^2}$ to $\SI{56}{\electronvolt^2}$
         \item[$\checkmark$] 8 zenith angle bins from -1 to 1
         \item[$\checkmark$] Flux normalization uncertainty of 25\%
         \item[$\checkmark$] Zenith angle uncertainty of 4\% 
         \item[$\checkmark$] No priors on oscillation parameters 
         \item[$\checkmark$] Marginalize $\dm$ and $\theta_{23}$. All other oscillation parameters are fixed.
      \end{itemize} 
\end{tabular}
\end{document}


